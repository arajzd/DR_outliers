---
title: "NMF_heatmap"
output: html_document
---

```{r setup}
library(NMF)
```

## R Markdown

```{r}
set.seed(100)
# random data that follow an 3-rank NMF model (with quite some noise)
X <- syntheticNMF(100, 3, 20, noise=0.1)
X_noisy <- syntheticNMF(100, 3, 20, noise=2)
# row annotations and covariates
```


```{r}
res <- nmf(X, 3, nrun=10)
res_noisy <- nmf(X_noisy, 3, nrun = 10, method = 'nsNMF')
par(c(1,2))
coefmap(minfit(res)) # it's H !
coefmap(minfit(res_noisy))

```


```{r}
res_cleaned <- rnmf(X_noisy, k = 2, showprogress = FALSE, my.seed = 100)
coefmap(res_cleaned$fit)

```
